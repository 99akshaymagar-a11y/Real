import React, { useState } from 'react';
import { Network, Database, Server, Shield, CreditCard, FileText, Users, Bell, BarChart3, Globe, GitBranch } from 'lucide-react';

const MicroservicesArchitecture = () => {
  const [selectedService, setSelectedService] = useState(null);

  const services = [
    {
      id: 'api-gateway',
      name: 'API Gateway',
      icon: Globe,
      color: 'bg-purple-500',
      description: 'Single entry point for all client requests. Handles routing, authentication, and rate limiting.',
      responsibilities: ['Request routing', 'Authentication', 'Rate limiting', 'Load balancing'],
      tech: ['Express.js', 'Kong', 'AWS API Gateway'],
      github: 'Can use Vercel/Netlify serverless functions'
    },
    {
      id: 'auth-service',
      name: 'Authentication Service',
      icon: Shield,
      color: 'bg-red-500',
      description: 'Manages user authentication, authorization, and session management.',
      responsibilities: ['User login/logout', 'JWT token generation', 'Password management', 'OAuth integration'],
      tech: ['Auth0', 'Firebase Auth', 'Custom JWT'],
      github: 'Firebase or Supabase Auth (free tier)'
    },
    {
      id: 'customer-service',
      name: 'Customer Service',
      icon: Users,
      color: 'bg-blue-500',
      description: 'Handles all customer-related operations and data management.',
      responsibilities: ['Customer CRUD operations', 'Profile management', 'Customer search', 'Contact information'],
      tech: ['Node.js', 'PostgreSQL', 'MongoDB'],
      github: 'Backend: Railway/Render, DB: Supabase'
    },
    {
      id: 'invoice-service',
      name: 'Invoice Service',
      icon: FileText,
      color: 'bg-green-500',
      description: 'Creates, manages, and tracks invoices and billing documents.',
      responsibilities: ['Invoice generation', 'PDF creation', 'Invoice versioning', 'Tax calculations'],
      tech: ['Node.js', 'PDFKit', 'PostgreSQL'],
      github: 'Backend: Vercel functions, Storage: S3/Cloudflare R2'
    },
    {
      id: 'payment-service',
      name: 'Payment Service',
      icon: CreditCard,
      color: 'bg-yellow-500',
      description: 'Processes payments and integrates with payment gateways.',
      responsibilities: ['Payment processing', 'Refunds', 'Payment method storage', 'Transaction history'],
      tech: ['Stripe API', 'PayPal SDK', 'Razorpay'],
      github: 'Serverless functions with Stripe/PayPal APIs'
    },
    {
      id: 'notification-service',
      name: 'Notification Service',
      icon: Bell,
      color: 'bg-pink-500',
      description: 'Sends notifications via email, SMS, and in-app channels.',
      responsibilities: ['Email notifications', 'Payment reminders', 'Invoice delivery', 'SMS alerts'],
      tech: ['SendGrid', 'Twilio', 'Firebase Cloud Messaging'],
      github: 'Vercel functions + SendGrid/Mailgun'
    },
    {
      id: 'reporting-service',
      name: 'Reporting Service',
      icon: BarChart3,
      color: 'bg-indigo-500',
      description: 'Generates reports, analytics, and business intelligence.',
      responsibilities: ['Revenue reports', 'Customer analytics', 'Payment trends', 'Export to CSV/PDF'],
      tech: ['Node.js', 'Chart.js', 'Data aggregation'],
      github: 'Frontend: React + Chart.js on GitHub Pages'
    }
  ];

  const databases = [
    { name: 'Customer DB', type: 'PostgreSQL', services: ['customer-service'] },
    { name: 'Invoice DB', type: 'PostgreSQL', services: ['invoice-service'] },
    { name: 'Payment DB', type: 'PostgreSQL', services: ['payment-service'] },
    { name: 'Cache', type: 'Redis', services: ['api-gateway', 'auth-service'] }
  ];

  return (
    <div className="w-full h-full bg-gradient-to-br from-slate-50 to-slate-100 p-8 overflow-auto">
      <div className="max-w-7xl mx-auto">
        <div className="mb-8">
          <div className="flex items-center gap-3 mb-4">
            <GitBranch className="w-8 h-8 text-slate-700" />
            <h1 className="text-3xl font-bold text-slate-800">Billing Software - Microservices Architecture</h1>
          </div>
          <p className="text-slate-600 text-lg">Designed for GitHub hosting with serverless deployment options</p>
        </div>

        <div className="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6 mb-8">
          {services.map((service) => {
            const Icon = service.icon;
            return (
              <div
                key={service.id}
                onClick={() => setSelectedService(service)}
                className="bg-white rounded-lg shadow-md hover:shadow-xl transition-all cursor-pointer border-2 border-transparent hover:border-blue-400 p-6"
              >
                <div className="flex items-start gap-4">
                  <div className={`${service.color} p-3 rounded-lg`}>
                    <Icon className="w-6 h-6 text-white" />
                  </div>
                  <div className="flex-1">
                    <h3 className="font-bold text-lg text-slate-800 mb-2">{service.name}</h3>
                    <p className="text-slate-600 text-sm mb-3">{service.description}</p>
                    <div className="flex flex-wrap gap-2">
                      {service.responsibilities.slice(0, 2).map((resp, idx) => (
                        <span key={idx} className="text-xs bg-slate-100 text-slate-700 px-2 py-1 rounded">
                          {resp}
                        </span>
                      ))}
                      {service.responsibilities.length > 2 && (
                        <span className="text-xs text-slate-500">+{service.responsibilities.length - 2} more</span>
                      )}
                    </div>
                  </div>
                </div>
              </div>
            );
          })}
        </div>

        {selectedService && (
          <div className="bg-white rounded-lg shadow-lg p-8 mb-8 border-2 border-blue-400">
            <div className="flex justify-between items-start mb-6">
              <div className="flex items-center gap-4">
                {React.createElement(selectedService.icon, { className: `w-10 h-10 ${selectedService.color} p-2 rounded-lg text-white` })}
                <div>
                  <h2 className="text-2xl font-bold text-slate-800">{selectedService.name}</h2>
                  <p className="text-slate-600">{selectedService.description}</p>
                </div>
              </div>
              <button
                onClick={() => setSelectedService(null)}
                className="text-slate-400 hover:text-slate-600 text-2xl"
              >
                Ã—
              </button>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <h3 className="font-bold text-slate-800 mb-3 flex items-center gap-2">
                  <Server className="w-5 h-5" />
                  Key Responsibilities
                </h3>
                <ul className="space-y-2">
                  {selectedService.responsibilities.map((resp, idx) => (
                    <li key={idx} className="text-slate-700 flex items-start gap-2">
                      <span className="text-blue-500 mt-1">â€¢</span>
                      <span>{resp}</span>
                    </li>
                  ))}
                </ul>
              </div>

              <div>
                <h3 className="font-bold text-slate-800 mb-3 flex items-center gap-2">
                  <Network className="w-5 h-5" />
                  Technology Stack
                </h3>
                <div className="space-y-2 mb-4">
                  {selectedService.tech.map((tech, idx) => (
                    <div key={idx} className="bg-slate-50 text-slate-700 px-3 py-2 rounded">
                      {tech}
                    </div>
                  ))}
                </div>

                <h3 className="font-bold text-slate-800 mb-3 flex items-center gap-2">
                  <GitBranch className="w-5 h-5" />
                  GitHub Hosting Strategy
                </h3>
                <div className="bg-green-50 text-green-800 px-3 py-2 rounded">
                  {selectedService.github}
                </div>
              </div>
            </div>
          </div>
        )}

        <div className="bg-white rounded-lg shadow-lg p-8 mb-8">
          <h2 className="text-2xl font-bold text-slate-800 mb-6 flex items-center gap-3">
            <Database className="w-7 h-7" />
            Database Architecture
          </h2>
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            {databases.map((db, idx) => (
              <div key={idx} className="bg-slate-50 rounded-lg p-4 border border-slate-200">
                <div className="flex items-center gap-2 mb-2">
                  <Database className="w-5 h-5 text-blue-600" />
                  <h3 className="font-bold text-slate-800">{db.name}</h3>
                </div>
                <p className="text-sm text-slate-600 mb-3">{db.type}</p>
                <div className="text-xs text-slate-500">
                  Used by: {db.services.length} service(s)
                </div>
              </div>
            ))}
          </div>
        </div>

        <div className="bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg shadow-lg p-8 text-white">
          <h2 className="text-2xl font-bold mb-4">GitHub Hosting Setup</h2>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <h3 className="font-bold mb-2 flex items-center gap-2">
                <Globe className="w-5 h-5" />
                Frontend Hosting
              </h3>
              <ul className="space-y-1 text-blue-100">
                <li>â€¢ GitHub Pages (React/Vue/HTML)</li>
                <li>â€¢ Vercel or Netlify (auto-deploy)</li>
                <li>â€¢ Free SSL certificates</li>
                <li>â€¢ Custom domain support</li>
              </ul>
            </div>
            <div>
              <h3 className="font-bold mb-2 flex items-center gap-2">
                <Server className="w-5 h-5" />
                Backend Hosting
              </h3>
              <ul className="space-y-1 text-blue-100">
                <li>â€¢ Vercel Serverless Functions</li>
                <li>â€¢ Railway or Render (free tier)</li>
                <li>â€¢ Supabase (PostgreSQL + Auth)</li>
                <li>â€¢ GitHub Actions for CI/CD</li>
              </ul>
            </div>
          </div>
        </div>

        <div className="mt-8 bg-yellow-50 border-l-4 border-yellow-400 p-6 rounded">
          <h3 className="font-bold text-yellow-800 mb-2">ðŸ’¡ Implementation Tips</h3>
          <ul className="text-yellow-700 space-y-1 text-sm">
            <li>â€¢ Start with a monorepo structure in GitHub for all microservices</li>
            <li>â€¢ Use environment variables for API keys and secrets</li>
            <li>â€¢ Implement proper error handling and logging</li>
            <li>â€¢ Add API documentation with Swagger/OpenAPI</li>
            <li>â€¢ Use GitHub Actions for automated testing and deployment</li>
          </ul>
        </div>
      </div>
    </div>
  );
};

export default MicroservicesArchitecture;
